{% extends "ews/base.html" %}
{% load leaflet_tags %}
 {% load geojson_tags %}

{% block head %}

 {% leaflet_css %}
 
  {% leaflet_js %}
  <style>

    .leaflet-container {  /* all maps */
        width:  100%;
        height: 400px;
    }

    #specialbigmap {
        height: 800px;
    }

    /* Resize the "display_raw" textbox */
    .django-leaflet-raw-textarea {
        width: 100%;
    }

</style>
{% endblock %}

{% block body %}
<div class="container" style="padding: 2%">
 <h4>Overview of available measurement sites</h4>
  <p>Click on the markers to see details and to add data</p>
  <div class="row">
    <div class="col-sm-8">
      <div>
      <script type="text/javascript">
        var collection = {{ entries|geojsonfeature:"popupContent,SiteType"|safe }};

        function onEachFeature(feature, layer) {
           if (feature.properties && feature.properties.popupContent) {
            layer.bindPopup(feature.properties.popupContent);
             }
            }
        
            var geojsonMarkerOptions = {
                          radius: 8,
                          fillColor: "rgb(0, 86, 110",
                          color: "grey",
                          weight: 1,
                          opacity: 1,
                          fillOpacity: 0.8
                      };

        function map_init(map, options) {

          L.geoJson(collection,{onEachFeature: onEachFeature, 
            pointToLayer: function (feature, latlng) {
             return L.circleMarker(latlng, geojsonMarkerOptions);
            },
            style: function(feature) {
         switch (feature.properties.SiteType) {
            case 'Network': return {fillColor: "brown", radius: 4};
            case 'WWTP':   return {fillColor: "red", radius: 12};
            case 'Riverflow':   return {fillColor: "orange", radius: 10};
            case 'River':   return {fillColor: "lightgreen", radius: 12};
            case 'Rainfall':   return {fillColor: "steelblue"};
            
        }
    }
           }).addTo(map);
        }

      </script>

      {% leaflet_map "spots" callback="window.map_init" %}


      </div>
   <!--
    <ul>
        {% for entry in entries %}
     <div class="media px-3 mt-3">
              <div class="media-left pr-3">
            
              <img class= "img-fluid" src="/static/ews/img/placeholder_dwc.png" alt="...">
            </a>
        </div>
        <div class="media-body">
                  <h4 class="media-heading">{{entry.name|title}}</h4>
                   <p> {{entry.description|capfirst}} 
                   
                   <a href= "{% url 'ews:file_upload' entry.id  %}", class = "btn-sm btn-primary sm"> Add data </a>
                   <a href= "{% url 'ews:site_detail' entry.id  %}", class = "btn-sm btn-secondary sm"> Details </a>
                   <a href= "{% url 'ews:delete_site' entry.id  %}", class = "btn-sm btn-danger sm"> Delete </a>
                
                </div>
        </div>
        {% empty %}
        <p>No predictor variable exist, yet. Create one and start modelling!</p>
        {% endfor %}
        
    </ul>
    -->
    </div>
  
    <div class="col-sm-3 offset-sm-1"> <!--style= "background-color: #007c9f; color: white">--> 
     <h4 class= "mb-3">Options</h4>
        <a class = "btn btn-primary mt-3 btn-block" href="{% url "ews:spot_create" %}"> Create new bathing spot</a>
        <a class = "btn btn-primary mt-3 btn-block" href="{% url 'ews:add_site'%}"> Create new predictor</a>
        <a class = "btn btn-primary mt-3 btn-block" href = "{% url "ews:model_config" %}"> Configure prediction model </a>

    </div>
{% endblock %}




            